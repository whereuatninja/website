extends layout

block content
    // Custom Slider CSS
    link(href='/css/bootstrap-slider.css', rel='stylesheet')
    link(href='/css/bootstrap-datepicker.css', rel='stylesheet')
    link(href='/css/pirate.css', rel='stylesheet')
    script(src='/scripts/bootstrap-slider.js')
    script(src='/scripts/bootstrap-datepicker.js')
    script(src='/scripts/pirate.js')
    .container
      .row
        .col-lg-2.sidebar
          ul.nav.nav-sidebar
            if viewModel.ninjas
              each ninja in viewModel.ninjas
                -var liClass = (viewModel.currentNinjaId == ninja.id) ? "active" : "";
                li(class=liClass)
                  a(href='/pirate/' + ninja.id) #{ninja.name}
        .col-lg-9.main
          if !viewModel.locations
            h3 No Locations Found!
          else
            h2.sub-header My Map
            #map
            if viewModel.locations
              h2.sub-header Time Range
              div.well
                b#slider-after-label After
                b#slider-timezone-label TimeZone
                b#slider-before-label Before
                br
                input#timeSlider(type='text')
                br
                button#button-datepicker.btn.btn-default.btn-lg(type='button', aria-label='Pick a Date') Pick a Date
                    span.glyphicon.glyphicon-calendar(aria-hidden='true', style='padding-left: .25em')
                button#button-filter.btn.btn-primary.btn-lg Filter
                  span#button-filter-loader.glyphicon.glyphicon-refresh.glyphicon-refresh-animate

            h2.sub-header Activities
            #whereubeen.table-responsive
            table#whereubeen.table.table-responsive.table-striped
              thead
                tr
                  th Longitude
                  th Latitude
                  th Time
              tbody
                each loc in viewModel.locations
                  tr
                    td= loc.lat
                    td= loc.long
                    -var time = new Date(loc.time).toUTCString();
                    td= time
            div#activityLoader
              strong Loading Activities...
              span#activity-loader.glyphicon.glyphicon-refresh.glyphicon-refresh-animate
            if viewModel.locations
              script(src='//maps.googleapis.com/maps/api/js?key=AIzaSyCKJnJars0xRRUHCtbzBgTG7TWMQLk_rYc')
              script(type='text/javascript').
                var ninjaId = "#{viewModel.ninjaId}";
                $(document).ready(function(){
                  var dateSlider = new WhereUAtDateSlider.initialize({
                      sliderId: "#timeSlider",
                      minSliderTime: "#{viewModel.minSliderTime}",
                      maxSliderTime: "#{viewModel.maxSliderTime}",
                      beforeLabelId: "slider-before-label",
                      afterLabelId: "slider-after-label",
                      timeZoneLabelId: "slider-timezone-label"
                  });
                  var mapModule = MapModule.initialize(document.getElementById('map'), !{JSON.stringify(viewModel.locations)});
                  var locationLoader = LocationLoader.initialize();
                  var locationDatePicker = LocationDatePicker.initialize("#{viewModel.minSliderTime}", "#{viewModel.maxSliderTime}");
                });

